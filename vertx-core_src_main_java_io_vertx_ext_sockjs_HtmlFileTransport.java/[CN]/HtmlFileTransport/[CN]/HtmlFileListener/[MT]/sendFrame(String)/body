{
  if (log.isTraceEnabled())   log.trace("HtmlFile, sending frame");
  if (!headersWritten) {
    String htmlFile=HTML_FILE_TEMPLATE.replace("{{ callback }}",callback);
    req.response().headers().set("Content-Type","text/html; charset=UTF-8");
    setNoCacheHeaders(req);
    req.response().setChunked(true);
    setJSESSIONID(config,req);
    req.response().write(htmlFile);
    headersWritten=true;
  }
  body=escapeForJavaScript(body);
  StringBuilder sb=new StringBuilder();
  sb.append("<script>\np(\"");
  sb.append(body);
  sb.append("\");\n</script>\r\n");
  Buffer buff=new Buffer(sb.toString());
  req.response().write(buff);
  bytesSent+=buff.length();
  if (bytesSent >= maxBytesStreaming) {
    if (log.isTraceEnabled())     log.trace("More than maxBytes sent so closing connection");
    close();
  }
}
