{
  if (client != null) {
    throw new IllegalStateException("Client already created");
  }
  client=vertx.createHttpClient();
  if (proxyHost != null) {
    client.setHost(proxyHost);
    if (proxyPort != 80) {
      client.setPort(proxyPort);
    }
 else {
      client.setPort(80);
    }
  }
 else {
    client.setHost(host);
    client.setPort(port);
  }
  if (scheme.equals("https")) {
    client.setSSL(true);
  }
  client.exceptionHandler(new Handler<Throwable>(){
    public void handle(    Throwable t){
      end(false);
    }
  }
);
  return client;
}
