{
  ConnectionHolder holder=connections.get(theServerID);
  if (holder == null) {
    holder=new ConnectionHolder(theServerID);
    ConnectionHolder prevHolder=connections.putIfAbsent(theServerID,holder);
    if (prevHolder != null) {
      holder=prevHolder;
    }
 else {
      holder.connect();
    }
  }
  holder.writeMessage(message);
}
