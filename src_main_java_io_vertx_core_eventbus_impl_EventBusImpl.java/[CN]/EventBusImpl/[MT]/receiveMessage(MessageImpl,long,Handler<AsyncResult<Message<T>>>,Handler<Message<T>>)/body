{
  msg.setBus(this);
  Handlers handlers=handlerMap.get(msg.address());
  if (handlers != null) {
    if (msg.send()) {
      HandlerHolder holder=handlers.choose();
      if (holder != null) {
        doReceive(msg,holder);
      }
    }
 else {
      for (      HandlerHolder holder : handlers.list) {
        doReceive(msg,holder);
      }
    }
  }
 else {
    if (replyHandler != null) {
      sendNoHandlersFailure(msg.address(),replyHandler);
      if (timeoutID != -1) {
        vertx.cancelTimer(timeoutID);
      }
      if (simpleReplyHandler != null) {
        unregisterHandler(msg.replyAddress(),simpleReplyHandler);
      }
    }
  }
}
