{
  int bytesLen=100;
  byte[] bytes=randomByteArray(bytesLen);
  Buffer src=new Buffer(bytes);
  int len=bytesLen - 2;
  Buffer b=new Buffer();
  b.setByte(0,(byte)'0');
  b.setBuffer(1,src,1,len);
  assertEquals(b.length(),len + 1);
  byte[] copy=new byte[len];
  System.arraycopy(bytes,1,copy,0,len);
  assertTrue(byteArraysEqual(copy,b.getBytes(1,b.length())));
  b.setBuffer(b.length(),src,1,len);
  assertEquals(b.length(),2 * len + 1);
}
