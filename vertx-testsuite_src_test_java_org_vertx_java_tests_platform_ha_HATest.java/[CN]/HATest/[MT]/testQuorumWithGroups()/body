{
  Cluster cluster=new Cluster();
  cluster.nodes.add(new NodeMods("group1",3));
  cluster.nodes.add(new NodeMods("group1",3));
  cluster.nodes.add(new NodeMods("group2",1));
  cluster.createCluster();
  NodeMods mods0=new NodeMods().addDeployment(new DepInfo("io.vertx~ha-test1~1.0")).addDeployment(new DepInfo("io.vertx~ha-test2~1.0"));
  NodeMods mods1=new NodeMods().addDeployment(new DepInfo("io.vertx~ha-test1~1.0")).addDeployment(new DepInfo("io.vertx~ha-test2~1.0"));
  NodeMods mods2=new NodeMods().addDeployment(new DepInfo("io.vertx~ha-test1~1.0")).addDeployment(new DepInfo("io.vertx~ha-test2~1.0"));
  cluster.deployModsNoCheck(0,mods0);
  cluster.deployModsNoCheck(1,mods1);
  cluster.deployModsNoCheck(2,mods2);
  Thread.sleep(500);
  assertTrue(cluster.pms.get(0).getDeployments().isEmpty());
  assertTrue(cluster.pms.get(1).getDeployments().isEmpty());
  cluster.checkModulesDeployed(2,mods2);
  cluster.addNode(new NodeMods("group1",3));
  cluster.checkModulesDeployed(0,mods0);
  cluster.checkModulesDeployed(1,mods1);
  cluster.checkModulesDeployedStill(2);
  cluster.closeCluster();
}
