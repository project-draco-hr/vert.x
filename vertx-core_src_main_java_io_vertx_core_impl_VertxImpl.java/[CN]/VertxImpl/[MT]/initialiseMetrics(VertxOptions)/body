{
  if (options.isMetricsEnabled()) {
    ServiceLoader<VertxMetricsFactory> factories=ServiceLoader.load(VertxMetricsFactory.class);
    if (factories.iterator().hasNext()) {
      VertxMetricsFactory factory=factories.iterator().next();
      return factory.metrics(this,options);
    }
 else {
      log.warn("Metrics has been set to enabled but no VertxMetricsFactory found on classpath");
      return new DummyVertxMetrics();
    }
  }
 else {
    return new DummyVertxMetrics();
  }
}
