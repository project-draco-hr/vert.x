{
  return new Handler<NetSocket>(){
    public void handle(    final NetSocket sock){
      tu.checkThread();
      tu.azzert(!sock.writeQueueFull());
      sock.setWriteQueueMaxSize(1000);
      final Buffer buff=TestUtils.generateRandomBuffer(10000);
      vertx.setPeriodic(1,new Handler<Long>(){
        public void handle(        Long id){
          tu.checkThread();
          sock.write(buff.copy());
          if (sock.writeQueueFull()) {
            vertx.cancelTimer(id);
            sock.drainHandler(new VoidHandler(){
              public void handle(){
                tu.checkThread();
                tu.azzert(!sock.writeQueueFull());
                vertx.setTimer(100,new Handler<Long>(){
                  public void handle(                  Long id){
                    tu.testComplete();
                  }
                }
);
              }
            }
);
            vertx.eventBus().send("client_resume","");
          }
        }
      }
);
    }
  }
;
}
