{
  final int numConnections=vertx.sharedData().<String,Integer>getMap("params").get("numConnections");
  final AtomicInteger counter=new AtomicInteger(0);
  for (int i=0; i < numConnections; i++) {
    client.connect(1234,"localhost",new AsyncResultHandler<NetSocket>(){
      public void handle(      AsyncResult<NetSocket> res){
        res.result().closeHandler(new VoidHandler(){
          public void handle(){
            int count=counter.incrementAndGet();
            if (count == numConnections) {
              tu.testComplete();
            }
          }
        }
);
      }
    }
);
  }
}
