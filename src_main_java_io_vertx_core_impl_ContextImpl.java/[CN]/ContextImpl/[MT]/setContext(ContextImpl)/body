{
  Thread current=Thread.currentThread();
  if (current instanceof VertxThread) {
    ((VertxThread)current).setContext(context);
    if (context != null) {
      context.setTCCL();
    }
 else {
      Thread.currentThread().setContextClassLoader(null);
    }
  }
 else {
    throw new IllegalStateException("Attempt to setContext on non Vert.x thread " + Thread.currentThread());
  }
}
