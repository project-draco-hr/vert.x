{
  int len=chunk.readableBytes();
  bytesWritten+=len;
  encoder.writeData(handlerContext,stream.id(),chunk,0,end,handlerContext.newPromise());
  Http2RemoteFlowController controller=encoder.flowController();
  if (!controller.isWritable(stream) || end) {
    try {
      encoder.flowController().writePendingBytes();
    }
 catch (    Http2Exception e) {
      e.printStackTrace();
    }
    channel.flush();
  }
}
