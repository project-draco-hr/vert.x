{
  File file=new File(fileName);
  if (!enableCPResolving) {
    return file;
  }
  if (!file.exists()) {
    File cacheFile=null;
    if (enableCaching && cacheDir != null) {
      cacheFile=new File(cacheDir,fileName);
      if (cacheFile.exists()) {
        return cacheFile;
      }
    }
    ClassLoader cl=getClassLoader();
    InputStream is=cl.getResourceAsStream(fileName);
    if (is != null) {
      boolean isDirectory=new File(fileName).getName().indexOf('.') == -1;
      if (cacheFile == null) {
        setupCacheDir();
        cacheFile=new File(cacheDir,fileName);
        if (isDirectory) {
          cacheFile.mkdirs();
        }
 else {
          cacheFile.getParentFile().mkdirs();
        }
      }
      if (!isDirectory) {
        try {
          Files.copy(is,cacheFile.toPath());
        }
 catch (        IOException e) {
          throw new VertxException("Failed to copy file",e);
        }
      }
      return cacheFile;
    }
  }
  return file;
}
