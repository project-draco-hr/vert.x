{
  HttpHeaders headers=request.headers();
  headers.remove(TRANSFER_ENCODING);
  if (!raw) {
    if (!headers.contains(HOST)) {
      request.headers().set(HOST,conn.hostHeader);
    }
    if (chunked) {
      HttpHeaders.setTransferEncodingChunked(request);
    }
  }
  if (client.getTryUseCompression() && request.headers().get(HttpHeaders.Names.ACCEPT_ENCODING) == null) {
    request.headers().set(HttpHeaders.Names.ACCEPT_ENCODING,"deflate, gzip");
  }
}
