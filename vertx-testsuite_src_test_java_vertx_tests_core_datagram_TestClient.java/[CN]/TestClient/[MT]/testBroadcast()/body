{
  peer1=vertx.createDatagramSocket(null);
  peer2=vertx.createDatagramSocket(null);
  peer2.exceptionHandler(new Handler<Throwable>(){
    @Override public void handle(    Throwable event){
      tu.azzert(false);
    }
  }
);
  peer2.setBroadcast(true);
  peer1.setBroadcast(true);
  peer2.listen(new InetSocketAddress(1234),new AsyncResultHandler<DatagramSocket>(){
    @Override public void handle(    AsyncResult<DatagramSocket> event){
      tu.checkThread();
      tu.azzert(event.succeeded());
      final Buffer buffer=TestUtils.generateRandomBuffer(128);
      peer2.dataHandler(new Handler<DatagramPacket>(){
        @Override public void handle(        DatagramPacket event){
          tu.checkThread();
          tu.azzert(event.data().equals(buffer));
          tu.testComplete();
        }
      }
);
      peer1.send(buffer,"255.255.255.255",1234,new AsyncResultHandler<DatagramSocket>(){
        @Override public void handle(        AsyncResult<DatagramSocket> event){
          tu.checkThread();
          tu.azzert(event.succeeded());
        }
      }
);
    }
  }
);
}
