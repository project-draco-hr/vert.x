{
  if (!keepAlive && pipelining) {
    waiter.handleFailure(new IllegalStateException("Cannot have pipelining with no keep alive"));
  }
 else {
    TargetAddress address=new TargetAddress(host,port);
    ConnQueue connQueue=options.getProtocolVersion() == HttpVersion.HTTP_2 ? qm2.getConnQueue(address) : qm.getConnQueue(address);
    connQueue.getConnection(waiter);
  }
}
