{
  int decodedTypeLength=readBuff.getInt(pos);
  pos+=4;
  if (decodedTypeLength > 0) {
    byte[] bytes=readBuff.getBytes(pos,pos + decodedTypeLength);
    pos+=decodedTypeLength;
    decodedType=new String(bytes,CharsetUtil.UTF_8);
  }
 else {
    throw new IllegalArgumentException("Could not parse decoded type from buffer");
  }
  codec=codecMap.get(decodedType);
  if (codec == null) {
    throw new RuntimeException("Unable to retrieve message codec for type " + decodedType);
  }
  boolean isNull=readBuff.getByte(pos) == (byte)0;
  if (!isNull) {
    pos++;
    int buffLength=readBuff.getInt(pos);
    pos+=4;
    byte[] bytes=readBuff.getBytes(pos,pos + buffLength);
    encodedData=Buffer.newBuffer(bytes);
    encoded=true;
  }
  body=codec.decode(encodedData);
}
