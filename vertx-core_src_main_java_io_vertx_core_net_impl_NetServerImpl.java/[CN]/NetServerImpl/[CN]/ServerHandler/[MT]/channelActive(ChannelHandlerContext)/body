{
  final Channel ch=ctx.channel();
  EventLoop worker=ch.eventLoop();
  final HandlerHolder<NetSocket> handler=handlerManager.chooseHandler(worker);
  if (handler == null) {
    return;
  }
  if (sslHelper.isSSL()) {
    SslHandler sslHandler=ch.pipeline().get(SslHandler.class);
    io.netty.util.concurrent.Future<Channel> fut=sslHandler.handshakeFuture();
    fut.addListener(new GenericFutureListener<io.netty.util.concurrent.Future<Channel>>(){
      @Override public void operationComplete(      io.netty.util.concurrent.Future<Channel> future) throws Exception {
        if (future.isSuccess()) {
          connected(ch,handler);
        }
 else {
          log.error("Client from origin " + ch.remoteAddress() + " failed to connect over ssl");
        }
      }
    }
);
  }
 else {
    connected(ch,handler);
  }
}
