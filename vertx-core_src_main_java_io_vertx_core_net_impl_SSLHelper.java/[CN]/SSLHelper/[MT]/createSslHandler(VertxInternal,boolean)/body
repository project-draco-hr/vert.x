{
  if (sslContext == null) {
    sslContext=createContext(vertx,keyStorePath,keyStorePassword,trustStorePath,trustStorePassword,trustAll);
  }
  SSLEngine engine=sslContext.createSSLEngine();
  String[] current=engine.getSupportedCipherSuites();
  if (enabledCipherSuites != null && !enabledCipherSuites.isEmpty()) {
    String[] toUse=enabledCipherSuites.toArray(new String[enabledCipherSuites.size()]);
    engine.setEnabledCipherSuites(toUse);
  }
  engine.setUseClientMode(client);
  if (!client) {
switch (getClientAuth()) {
case REQUEST:
{
        engine.setWantClientAuth(true);
        break;
      }
case REQUIRED:
{
      engine.setNeedClientAuth(true);
      break;
    }
case NONE:
{
    engine.setNeedClientAuth(false);
    break;
  }
}
}
return new SslHandler(engine);
}
