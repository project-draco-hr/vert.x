{
  if (buffer.readableBytes() < 2) {
    return;
  }
  final int magic1=buffer.getUnsignedByte(buffer.readerIndex());
  final int magic2=buffer.getUnsignedByte(buffer.readerIndex() + 1);
  boolean isFlashPolicyRequest=(magic1 == '<' && magic2 == 'p');
  if (isFlashPolicyRequest) {
    buffer.skipBytes(buffer.readableBytes());
    removeAllPipelineHandlers(ctx.pipeline());
    ctx.writeAndFlush(policyResponse).addListener(ChannelFutureListener.CLOSE);
    return;
  }
  ctx.pipeline().remove(this);
}
