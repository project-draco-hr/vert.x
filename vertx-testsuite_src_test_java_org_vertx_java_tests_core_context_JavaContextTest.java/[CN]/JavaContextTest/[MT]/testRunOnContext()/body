{
  final CountDownLatch latch=new CountDownLatch(1);
  final Vertx vertx=VertxFactory.newVertx();
  vertx.runOnContext(new VoidHandler(){
    @Override protected void handle(){
      final Thread th=Thread.currentThread();
      final Context ctx=vertx.currentContext();
      ctx.runOnContext(new VoidHandler(){
        @Override protected void handle(){
          assertTrue(Thread.currentThread() == th);
          assertTrue(vertx.currentContext() == ctx);
          new Thread(){
            public void run(){
              ctx.runOnContext(new VoidHandler(){
                @Override protected void handle(){
                  assertTrue(Thread.currentThread() == th);
                  assertTrue(vertx.currentContext() == ctx);
                  latch.countDown();
                }
              }
);
            }
          }
.start();
        }
      }
);
    }
  }
);
  while (true) {
    try {
      assertTrue(latch.await(5,TimeUnit.SECONDS));
      break;
    }
 catch (    InterruptedException ignore) {
    }
  }
}
