{
  if (connection != null) {
    Channel ch=chctx.channel();
    if (context.isOnCorrectWorker(ch.eventLoop())) {
      try {
        vertx.setContext(context);
        doMessageReceived(connection,chctx,msg);
      }
 catch (      Throwable t) {
        context.reportException(t);
      }
    }
 else {
      context.execute(new Runnable(){
        public void run(){
          try {
            doMessageReceived(connection,chctx,msg);
          }
 catch (          Throwable t) {
            context.reportException(t);
          }
        }
      }
);
    }
  }
 else {
    try {
      doMessageReceived(connection,chctx,msg);
    }
 catch (    Throwable t) {
      chctx.pipeline().fireExceptionCaught(t);
    }
  }
}
