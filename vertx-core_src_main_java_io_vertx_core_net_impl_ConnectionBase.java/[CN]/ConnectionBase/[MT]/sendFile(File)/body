{
  final RandomAccessFile raf;
  try {
    raf=new RandomAccessFile(file,"r");
    long fileLength=file.length();
    ChannelFuture writeFuture;
    if (!supportsFileRegion()) {
      writeFuture=writeToChannel(new ChunkedFile(raf,0,fileLength,8192));
    }
 else {
      final FileRegion region=new DefaultFileRegion(raf.getChannel(),0,fileLength);
      writeFuture=writeToChannel(region);
    }
    writeFuture.addListener(new ChannelFutureListener(){
      public void operationComplete(      ChannelFuture future) throws Exception {
        raf.close();
      }
    }
);
    return writeFuture;
  }
 catch (  IOException e) {
    handleException(e);
    return null;
  }
}
