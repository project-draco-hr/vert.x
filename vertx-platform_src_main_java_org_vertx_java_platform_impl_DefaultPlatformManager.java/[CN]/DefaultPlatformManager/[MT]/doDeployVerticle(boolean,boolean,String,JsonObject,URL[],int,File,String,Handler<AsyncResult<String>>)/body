{
  checkWorkerContext();
  if (main == null) {
    throw new NullPointerException("main cannot be null");
  }
  if (urls == null) {
    throw new IllegalStateException("deployment classpath for deploy is null");
  }
  String depName=genDepName();
  ModuleIdentifier enclosingModName=getEnclosingModID();
  String moduleKey;
  if (enclosingModName == null) {
    moduleKey=ModuleIdentifier.createInternalModIDForVerticle(depName).toString();
  }
 else {
    moduleKey=enclosingModName.toString() + "#" + main;
  }
  ModuleReference mr=getModuleReference(moduleKey,urls);
  if (enclosingModName != null) {
    ModuleReference parentRef=moduleRefs.get(enclosingModName.toString());
    mr.mcl.addParent(parentRef);
    parentRef.incRef();
  }
  if (includes != null) {
    loadIncludedModules(modRoot,currentModDir,mr,includes);
  }
  doDeploy(depName,false,worker,multiThreaded,main,null,config,urls,instances,currentModDir,mr,modRoot,false,doneHandler);
}
