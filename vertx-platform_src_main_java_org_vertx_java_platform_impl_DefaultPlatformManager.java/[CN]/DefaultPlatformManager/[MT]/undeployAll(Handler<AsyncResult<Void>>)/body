{
  List<String> parents=new ArrayList<>();
  for (  Map.Entry<String,Deployment> entry : deployments.entrySet()) {
    if (entry.getValue().parentDeploymentName == null) {
      parents.add(entry.getKey());
    }
  }
  final CountingCompletionHandler<Void> count=new CountingCompletionHandler<>(vertx,parents.size());
  count.setHandler(doneHandler);
  for (  String name : parents) {
    undeploy(name,new Handler<AsyncResult<Void>>(){
      public void handle(      AsyncResult<Void> res){
        if (res.failed()) {
          count.failed(res.cause());
        }
 else {
          count.complete();
        }
      }
    }
);
  }
}
