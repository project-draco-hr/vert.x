{
  Deployment topMostMod=dep;
  while (true) {
    String parentDep=dep.parentDeploymentName;
    if (parentDep != null) {
      dep=deployments.get(parentDep);
      if (dep == null) {
        throw new IllegalStateException("Cannot find deployment " + parentDep);
      }
      if (dep.modID != null) {
        topMostMod=dep;
      }
    }
 else {
      return topMostMod;
    }
  }
}
